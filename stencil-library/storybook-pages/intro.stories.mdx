import { Canvas, Meta, Story, Source } from '@storybook/addon-docs';
import { Markdown } from '@storybook/blocks';
import dedent from 'ts-dedent';
import { extractVersionFromPackage } from './utils.tsx'
import Changelog from '../CHANGELOG.md';

<Meta title="Introduction" />

# Introduction to JustiFi Web Component Library

{/* This function would be potentially dangerous in the context of a private repository */}
{/* In this case since the repo is public, the package.json file is public already */}
Latest Version: <code>{extractVersionFromPackage()}</code>

# Index

- [Usage](#usage)
- [Default Styling](#default-styling)
- [React](#react)
- [Styling](#styling)
  - [Styling iFramed components with variables](#styling-components-with-variables)
  - [Styling components with custom css](#styling-components-with-custom-css)
- [Changelog](/docs/changelog--docs)


# Usage

The components can be used as HTML Web Components or as React components.

## HTML Web Components

The simplest way to use the Web Components is to include the following script within your HTML. This loads all the components into the browsers custom component registry.

<Source
  language='html'
  dark
  format={false}
  code={dedent`
    <script type='module' src='https://cdn.jsdelivr.net/npm/@justifi/webcomponents@${extractVersionFromPackage()}/dist/webcomponents/webcomponents.esm.js'></script>
  `}
/>

Then, you can use the custom elements as normal `HTML` tags.

<Source
  language='html'
  dark
  format={false}
  code={dedent`
    <justifi-payment-form attr="value" />
  `}
/>

It can also be installed as a package with `npm` or `yarn`

<Source
  language='bash'
  dark
  format={false}
  code={dedent`
    npm install --save @justifi/webcomponents
  `}
/>

### Default styling

In both cases, you most likely will also want to include the `CSS` file for the components to have their default styling (that you can override).

It can be included from the CDN, which is easier to start with, but won't update as the version changes in the package installed in you `package.json`:

<Source
  language='html'
  dark
  format={false}
  code={dedent`
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@justifi/webcomponents@${extractVersionFromPackage()}/dist/webcomponents/webcomponents.css" />
  `}
/>

If you want to include it from the `node_modules` you'll need to get this file to the static directory of your built app in your pipeline:

<Source
  language='html'
  dark
  format={false}
  code={dedent`
    <link rel="stylesheet" href="path/to/your/static/assets/webcomponents.css" />
  `}
/>


## React

To use the React version of the web components, you need to install the package:

<Source
  language='bash'
  dark
  format={false}
  code={dedent`
    npm install --save @justifi/react-components
  `}
/>

Then import it and use it as a normal React component, for a more in-depth explanation you can search the sidebar for the component you want to use:

<Source
  language='jsx'
  dark
  format={false}
  code={dedent`
    import { JustifiCardForm } from '@justifi/react-components';

    <JustifiCardForm
      ref={cardFormRef}
      onCardFormReady={onPaymentMethodReady}
    />
  `}
/>

# Styling

## Styling components with variables

The following components need to be styled by overriding `CSS variables`, since they are scoped within an iFrame:
- [BankAccountForm](#)
- [CardForm](#)
- [PaymentForm](#)

This is a complete list of variables as defined in this project's `root.scss`:

_Note: The syntax `#{$variable}` is used to interpolate variables from bootstrap_

<Source
  language='css'
  dark
  code={dedent`
  /* layout */
  --jfi-layout-padding: 4px;
  --jfi-layout-form-control-spacing-x: .5rem;
  --jfi-layout-form-control-spacing-y: 1rem;

  /* colors */
  --jfi-primary-color: #{$primary};

  /* form control */
  --jfi-form-control-background-color: #{$input-bg};
  --jfi-form-control-border-color: #{$input-border-color};
  --jfi-form-control-border-color-focus: #{$input-focus-border-color};
  --jfi-form-control-border-color-error: #{$form-feedback-invalid-color};
  --jfi-form-control-border-width: 1px;
  --jfi-form-control-border-bottom-width: 1px;
  --jfi-form-control-border-left-width: 1px;
  --jfi-form-control-border-right-width: 1px;
  --jfi-form-control-border-top-width: 1px;
  --jfi-form-control-border-radius: #{$border-radius};
  --jfi-form-control-border-style: solid;
  --jfi-form-control-box-shadow: none;
  --jfi-form-control-box-shadow-error: none;
  --jfi-form-control-box-shadow-error-focus: #{0 0 0 0.25rem rgba($form-feedback-invalid-color, 0.25)};
  --jfi-form-control-box-shadow-focus: #{$input-focus-box-shadow};
  --jfi-form-control-color: #{$input-color};
  --jfi-form-control-color-focus: #{input-color-focus};
  --jfi-form-control-font-size: #{$input-font-size};
  --jfi-form-control-font-weight: #{$input-font-weight};
  --jfi-form-control-line-height: #{$input-line-height};
  --jfi-form-control-margin: 0;
  --jfi-form-control-padding: #{$input-padding-y $input-padding-x};

  /* form radio group */
  --jfi-radio-button-color: var(--jfi-primary-color);
  --jfi-radio-button-background-color: transparent;
  --jfi-radio-button-color-selected: white;
  --jfi-radio-button-background-color-selected: var(--jfi-primary-color);
  --jfi-radio-button-border-color: var(--jfi-primary-color);
  --jfi-radio-button-border-color-selected: var(--jfi-primary-color);
  --jfi-radio-button-padding: #{$input-padding-y $input-padding-x};
  --jfi-radio-button-font-size: #{$input-font-size};
  --jfi-radio-button-color-hover: var(--jfi-primary-color);
  --jfi-radio-button-color-selected-hover: white;
  --jfi-radio-button-background-color-hover: transparent;
  --jfi-radio-button-background-color-selected-hover: var(--jfi-primary-color);
  --jfi-radio-button-border-color-selected-hover: var(--jfi-primary-color);
  --jfi-radio-button-border-color-hover: var(--jfi-primary-color);

  /* submit button */
  --jfi-submit-button-color: white;
  --jfi-submit-button-background-color: var(--jfi-primary-color);
  --jfi-submit-button-border-color: var(--jfi-primary-color);
  --jfi-submit-button-padding: #{$input-padding-y $input-padding-x};
  --jfi-submit-button-font-size: #{$input-font-size};
  --jfi-submit-button-border-radius: #{$border-radius};
  --jfi-submit-button-color-hover: white;
  --jfi-submit-button-background-color-hover: var(--jfi-primary-color);
  --jfi-submit-button-border-color-hover: var(--jfi-primary-color);
  --jfi-submit-button-color-focus: white;
  --jfi-submit-button-background-color-focus: var(--jfi-primary-color);
  --jfi-submit-button-border-color-focus: var(--jfi-primary-color);
  --jfi-submit-button-color-active: white;
  --jfi-submit-button-background-color-active: var(--jfi-primary-color);
  --jfi-submit-button-border-color-active: var(--jfi-primary-color);

  /* form label */
  --jfi-form-label-color: #{$body-color};
  --jfi-form-label-font-family: #{$font-family-base};
  --jfi-form-label-font-size: #{$font-size-base};
  --jfi-form-label-font-weight: 400;
  --jfi-form-label-margin: 0 0 #{$form-label-margin-bottom} 0;

  /* validation messages */
  --jfi-error-message-color: #{$form-feedback-invalid-color};
  --jfi-error-message-margin: #{$form-feedback-margin-top} 0 0 0;
  --jfi-error-message-font-size: #{$form-feedback-font-size};
  `}
/>

## Styling components with custom css

For every other component, you'll be able to see a list of `exportedparts` in their `Docs` page. These exported `parts` can be used in the following manner:

<Source
  language='css'
  dark
  code={dedent`
    /* Given an exportedpart of "label" for example */
    the-component-tag:part(label) {
      /* Your custom css */
    }
  `}
/>
